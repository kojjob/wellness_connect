<div class="min-h-screen bg-gray-50">
  <!-- Breadcrumb Navigation -->
  <div class="bg-white border-b border-gray-200">
    <div class="container mx-auto px-4 py-3">
      <nav class="flex items-center gap-2 text-sm" aria-label="Breadcrumb">
        <%= link_to "Home", root_path, class: "text-gray-600 hover:text-indigo-600 transition" %>
        <svg class="w-4 h-4 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
          <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
        </svg>
        <%= link_to "Providers", provider_profiles_path, class: "text-gray-600 hover:text-indigo-600 transition" %>
        <svg class="w-4 h-4 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
          <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
        </svg>
        <span class="text-gray-900 font-medium"><%= @provider_profile.full_name %></span>
      </nav>
    </div>
  </div>

  <!-- Hero/Header Section -->
  <section class="relative bg-gradient-to-br from-indigo-600 via-purple-600 to-indigo-800 text-white overflow-hidden">
    <!-- Decorative background elements -->
    <div class="absolute inset-0 opacity-10">
      <div class="absolute top-0 left-0 w-96 h-96 bg-white rounded-full filter blur-3xl"></div>
      <div class="absolute bottom-0 right-0 w-96 h-96 bg-white rounded-full filter blur-3xl"></div>
    </div>

    <div class="relative container mx-auto px-4 pt-12 pb-32">
      <div class="flex flex-col lg:flex-row items-center lg:items-start gap-8">
        <!-- Avatar Section -->
        <div class="flex-shrink-0">
          <div class="relative">
            <% if @provider_profile.avatar.attached? %>
              <%= image_tag @provider_profile.avatar,
                  alt: "#{@provider_profile.full_name} - Profile Photo",
                  class: "w-48 h-48 rounded-full object-cover border-8 border-white shadow-2xl" %>
            <% else %>
              <div class="w-48 h-48 rounded-full bg-white/20 backdrop-blur-sm border-8 border-white shadow-2xl flex items-center justify-center">
                <svg class="w-24 h-24 text-white" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
              </div>
            <% end %>

            <!-- Verification Badge -->
            <div class="absolute bottom-2 right-2 bg-green-500 rounded-full p-2 border-4 border-white shadow-lg"
                 title="Verified Provider"
                 aria-label="Verified Provider">
              <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
              </svg>
            </div>
          </div>
        </div>

        <!-- Provider Info -->
        <div class="flex-1 text-center lg:text-left">
          <h1 class="text-4xl lg:text-5xl font-bold mb-2">
            <%= @provider_profile.full_name %>
          </h1>

          <p class="text-xl lg:text-2xl text-indigo-100 mb-4">
            <%= @provider_profile.credentials %>
          </p>

          <div class="flex flex-wrap items-center justify-center lg:justify-start gap-3 mb-6">
            <span class="inline-flex items-center px-4 py-2 bg-white/20 backdrop-blur-sm rounded-full text-sm font-medium">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
              </svg>
              <%= @provider_profile.specialty %>
            </span>

            <% if @provider_profile.years_of_experience.present? %>
              <span class="inline-flex items-center px-4 py-2 bg-white/20 backdrop-blur-sm rounded-full text-sm font-medium">
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                </svg>
                <%= @provider_profile.years_of_experience %> Years Experience
              </span>
            <% end %>
          </div>

          <!-- Rating -->
          <div class="flex items-center justify-center lg:justify-start gap-2 mb-6">
            <div class="flex items-center">
              <% 5.times do |i| %>
                <svg class="w-6 h-6 <%= i < @provider_profile.display_rating.floor ? 'text-yellow-400' : 'text-white/30' %>"
                     fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                </svg>
              <% end %>
            </div>
            <span class="text-2xl font-bold"><%= @provider_profile.display_rating %></span>
          </div>

          <!-- Quick Action Buttons -->
          <div class="flex flex-wrap gap-3 justify-center lg:justify-start mb-8">
            <% if user_signed_in? && current_user.patient? %>
              <% first_service = @provider_profile.services.where(is_active: true).first %>
              <%= link_to new_appointment_path(service_id: first_service&.id),
                  class: "inline-flex items-center px-6 py-3 bg-white text-indigo-600 rounded-lg font-semibold hover:bg-indigo-50 transition shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",
                  data: { turbo: false } do %>
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                </svg>
                Book Appointment
              <% end %>
            <% elsif !user_signed_in? %>
              <%= link_to new_user_session_path,
                  class: "inline-flex items-center px-6 py-3 bg-white text-indigo-600 rounded-lg font-semibold hover:bg-indigo-50 transition shadow-lg hover:shadow-xl transform hover:-translate-y-0.5" do %>
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                </svg>
                Book Appointment
              <% end %>
            <% end %>

            <button class="inline-flex items-center px-6 py-3 bg-white/20 backdrop-blur-sm text-white rounded-lg font-semibold hover:bg-white/30 transition border-2 border-white/50">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
              </svg>
              Message
            </button>

            <button class="inline-flex items-center px-6 py-3 bg-white/20 backdrop-blur-sm text-white rounded-lg font-semibold hover:bg-white/30 transition border-2 border-white/50">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/>
              </svg>
              Share
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Wave divider -->
    <div class="absolute bottom-0 left-0 right-0">
      <svg viewBox="0 0 1440 120" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full h-auto">
        <path d="M0 0L60 10C120 20 240 40 360 46.7C480 53 600 47 720 43.3C840 40 960 40 1080 46.7C1200 53 1320 67 1380 73.3L1440 80V120H1380C1320 120 1200 120 1080 120C960 120 840 120 720 120C600 120 480 120 360 120C240 120 120 120 60 120H0V0Z"
              fill="#F9FAFB"/>
      </svg>
    </div>
  </section>

  <!-- Main Content Area -->
  <div class="container mx-auto px-4 py-12">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Main Content (2/3 width) -->
      <div class="lg:col-span-2">
        <!-- Tabbed Navigation -->
        <div class="bg-white rounded-2xl shadow-lg mb-8" data-controller="tabs" data-tabs-default-tab-value="about">
          <div class="border-b border-gray-200 px-6">
            <nav class="-mb-px flex space-x-8 overflow-x-auto" aria-label="Content tabs" role="tablist">
              <button data-tabs-target="tab" 
                      data-tab-id="about"
                      data-action="click->tabs#selectTab keydown->tabs#handleKeydown"
                      role="tab"
                      class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                <span class="flex items-center gap-2">
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                  </svg>
                  About
                </span>
              </button>

              <button data-tabs-target="tab" 
                      data-tab-id="services"
                      data-action="click->tabs#selectTab keydown->tabs#handleKeydown"
                      role="tab"
                      class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                <span class="flex items-center gap-2">
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
                  </svg>
                  Services
                </span>
              </button>

              <% if @provider_profile.gallery_images.attached? || @provider_profile.gallery_videos.attached? || @provider_profile.documents.attached? %>
                <button data-tabs-target="tab" 
                        data-tab-id="media"
                        data-action="click->tabs#selectTab keydown->tabs#handleKeydown"
                        role="tab"
                        class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                  <span class="flex items-center gap-2">
                    <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
                    </svg>
                    Media
                  </span>
                </button>
              <% end %>

              <button data-tabs-target="tab" 
                      data-tab-id="reviews"
                      data-action="click->tabs#selectTab keydown->tabs#handleKeydown"
                      role="tab"
                      class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                <span class="flex items-center gap-2">
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                  </svg>
                  Reviews
                </span>
              </button>

              <button data-tabs-target="tab" 
                      data-tab-id="faq"
                      data-action="click->tabs#selectTab keydown->tabs#handleKeydown"
                      role="tab"
                      class="whitespace-nowrap py-4 px-1 border-b-2 font-medium text-sm transition-colors focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                <span class="flex items-center gap-2">
                  <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/>
                  </svg>
                  FAQ
                </span>
              </button>
            </nav>
          </div>

          <!-- Tab Panels -->
          <div class="p-6">
            <!-- About Panel -->
            <div data-tabs-target="panel" data-tab-id="about" role="tabpanel">
              <%= render 'provider_profiles/sections/about' %>
            </div>

            <!-- Services Panel -->
            <div data-tabs-target="panel" data-tab-id="services" class="hidden" role="tabpanel" aria-hidden="true">
              <%= render 'provider_profiles/sections/services' %>
            </div>

            <!-- Media Panel -->
            <% if @provider_profile.gallery_images.attached? || @provider_profile.gallery_videos.attached? || @provider_profile.documents.attached? %>
              <div data-tabs-target="panel" data-tab-id="media" class="hidden" role="tabpanel" aria-hidden="true">
                <%= render 'provider_profiles/sections/media_gallery' %>
              </div>
            <% end %>

            <!-- Reviews Panel -->
            <div data-tabs-target="panel" data-tab-id="reviews" class="hidden" role="tabpanel" aria-hidden="true">
              <%= render 'provider_profiles/sections/reviews' %>
            </div>

            <!-- FAQ Panel -->
            <div data-tabs-target="panel" data-tab-id="faq" class="hidden" role="tabpanel" aria-hidden="true">
              <%= render 'provider_profiles/sections/faq' %>
            </div>
          </div>
        </div>
      </div>

      <!-- Sidebar (1/3 width, sticky) -->
      <div class="lg:col-span-1">
        <div class="sticky top-24 space-y-6">
          <!-- Quick Stats -->
          <%= render 'provider_profiles/sections/quick_stats' %>

          <!-- Contact Info -->
          <%= render 'provider_profiles/sections/contact_info' %>

          <!-- Office Hours -->
          <%= render 'provider_profiles/sections/office_hours' %>

          <!-- Insurance -->
          <%= render 'provider_profiles/sections/insurance' %>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin Actions (only visible to profile owner) -->
  <% if user_signed_in? && policy(@provider_profile).edit? %>
    <div class="fixed bottom-6 right-6 flex flex-col gap-3 z-50">
      <%= link_to edit_provider_profile_path(@provider_profile),
          class: "flex items-center justify-center w-14 h-14 bg-indigo-600 text-white rounded-full shadow-lg hover:bg-indigo-700 transition",
          title: "Edit Profile" do %>
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
          <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
        </svg>
      <% end %>
    </div>
  <% end %>
</div>

