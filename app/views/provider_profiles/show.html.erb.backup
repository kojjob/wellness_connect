<div class="min-h-screen bg-gray-50">
  <!-- Hero/Header Section -->
  <section class="relative bg-gradient-to-br from-indigo-600 via-purple-600 to-indigo-800 text-white overflow-hidden">
    <!-- Decorative background elements -->
    <div class="absolute inset-0 opacity-10">
      <div class="absolute top-0 left-0 w-96 h-96 bg-white rounded-full filter blur-3xl"></div>
      <div class="absolute bottom-0 right-0 w-96 h-96 bg-white rounded-full filter blur-3xl"></div>
    </div>

    <div class="relative container mx-auto px-4 pt-24 pb-32">
      <div class="flex flex-col lg:flex-row items-center lg:items-start gap-8">
        <!-- Avatar Section -->
        <div class="flex-shrink-0">
          <div class="relative">
            <% if @provider_profile.avatar.attached? %>
              <%= image_tag @provider_profile.avatar,
                  alt: "#{@provider_profile.full_name} - Profile Photo",
                  class: "w-48 h-48 rounded-full object-cover border-8 border-white shadow-2xl" %>
            <% else %>
              <div class="w-48 h-48 rounded-full bg-white/20 backdrop-blur-sm border-8 border-white shadow-2xl flex items-center justify-center">
                <svg class="w-24 h-24 text-white" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                </svg>
              </div>
            <% end %>

            <!-- Verification Badge -->
            <div class="absolute bottom-2 right-2 bg-green-500 rounded-full p-2 border-4 border-white shadow-lg"
                 title="Verified Provider"
                 aria-label="Verified Provider">
              <svg class="w-6 h-6 text-white" fill="currentColor" viewBox="0 0 24 24">
                <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
              </svg>
            </div>
          </div>
        </div>

        <!-- Provider Info -->
        <div class="flex-1 text-center lg:text-left">
          <h1 class="text-4xl lg:text-5xl font-bold mb-2">
            <%= @provider_profile.full_name %>
          </h1>

          <p class="text-xl lg:text-2xl text-indigo-100 mb-4">
            <%= @provider_profile.credentials %>
          </p>

          <div class="flex flex-wrap items-center justify-center lg:justify-start gap-3 mb-6">
            <span class="inline-flex items-center px-4 py-2 bg-white/20 backdrop-blur-sm rounded-full text-sm font-medium">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
              </svg>
              <%= @provider_profile.specialty %>
            </span>

            <% if @provider_profile.years_of_experience.present? %>
              <span class="inline-flex items-center px-4 py-2 bg-white/20 backdrop-blur-sm rounded-full text-sm font-medium">
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/>
                </svg>
                <%= @provider_profile.years_of_experience %> Years Experience
              </span>
            <% end %>
          </div>

          <!-- Rating -->
          <div class="flex items-center justify-center lg:justify-start gap-2 mb-6">
            <div class="flex items-center">
              <% 5.times do |i| %>
                <svg class="w-6 h-6 <%= i < @provider_profile.display_rating.floor ? 'text-yellow-400' : 'text-white/30' %>"
                     fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"/>
                </svg>
              <% end %>
            </div>
            <span class="text-2xl font-bold"><%= @provider_profile.display_rating %></span>
            <span class="text-indigo-100">(<%= @provider_profile.total_reviews %> reviews)</span>
          </div>

          <!-- Quick Action Buttons -->
          <div class="flex flex-wrap gap-3 justify-center lg:justify-start mb-8">
            <% if user_signed_in? && current_user.patient? %>
              <%= link_to "#services",
                  class: "inline-flex items-center px-6 py-3 bg-white text-indigo-600 rounded-lg font-semibold hover:bg-indigo-50 transition shadow-lg" do %>
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                </svg>
                View Services
              <% end %>
            <% elsif !user_signed_in? %>
              <%= link_to new_user_session_path,
                  class: "inline-flex items-center px-6 py-3 bg-white text-indigo-600 rounded-lg font-semibold hover:bg-indigo-50 transition shadow-lg" do %>
                <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                </svg>
                Sign In to Book
              <% end %>
            <% end %>

            <button class="inline-flex items-center px-6 py-3 bg-white/20 backdrop-blur-sm text-white rounded-lg font-semibold hover:bg-white/30 transition border-2 border-white/50">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
              </svg>
              Message
            </button>

            <button class="inline-flex items-center px-6 py-3 bg-white/20 backdrop-blur-sm text-white rounded-lg font-semibold hover:bg-white/30 transition border-2 border-white/50">
              <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 24 24">
                <path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81 1.66 0 3-1.34 3-3s-1.34-3-3-3-3 1.34-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9c-1.66 0-3 1.34-3 3s1.34 3 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.16c-.05.21-.08.43-.08.65 0 1.61 1.31 2.92 2.92 2.92 1.61 0 2.92-1.31 2.92-2.92s-1.31-2.92-2.92-2.92z"/>
              </svg>
              Share
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Wave divider -->
    <div class="absolute bottom-0 left-0 right-0">
      <svg viewBox="0 0 1440 120" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full h-auto">
        <path d="M0 0L60 10C120 20 240 40 360 46.7C480 53 600 47 720 43.3C840 40 960 40 1080 46.7C1200 53 1320 67 1380 73.3L1440 80V120H1380C1320 120 1200 120 1080 120C960 120 840 120 720 120C600 120 480 120 360 120C240 120 120 120 60 120H0V0Z"
              fill="#F9FAFB"/>
      </svg>
    </div>
  </section>

  <div class="container mx-auto px-4 py-12">
    <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
      <!-- Main Content -->
      <div class="lg:col-span-2 space-y-8">
        <!-- About Section -->
        <section id="about" class="bg-white rounded-2xl shadow-lg p-8">
          <h2 class="text-2xl font-bold text-gray-900 mb-6">About <%= @provider_profile.user.first_name %></h2>

          <div class="prose max-w-none text-gray-700 leading-relaxed mb-8">
            <%= simple_format(@provider_profile.bio) %>
          </div>

          <!-- Credentials & Qualifications -->
          <% if @provider_profile.credentials.present? %>
            <div class="mb-8 pb-8 border-b border-gray-200">
              <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
                <svg class="w-5 h-5 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
                </svg>
                Credentials & Qualifications
              </h3>
              <div class="flex flex-wrap gap-3">
                <% @provider_profile.credentials.split(',').each do |credential| %>
                  <span class="px-4 py-2 bg-indigo-50 text-indigo-700 rounded-lg font-medium text-sm">
                    <%= credential.strip %>
                  </span>
                <% end %>
              </div>
            </div>
          <% end %>

          <!-- Education -->
          <% if @provider_profile.education.present? %>
            <div class="mb-8 pb-8 border-b border-gray-200">
              <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
                <svg class="w-5 h-5 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M5 13.18v4L12 21l7-3.82v-4L12 17l-7-3.82zM12 3L1 9l11 6 9-4.91V17h2V9L12 3z"/>
                </svg>
                Education
              </h3>
              <div class="prose max-w-none text-gray-700">
                <%= simple_format(@provider_profile.education) %>
              </div>
            </div>
          <% end %>

          <!-- Languages -->
          <% if @provider_profile.languages.present? %>
            <div>
              <h3 class="text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2">
                <svg class="w-5 h-5 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zm6.93 6h-2.95c-.32-1.25-.78-2.45-1.38-3.56 1.84.63 3.37 1.91 4.33 3.56zM12 4.04c.83 1.2 1.48 2.53 1.91 3.96h-3.82c.43-1.43 1.08-2.76 1.91-3.96zM4.26 14C4.1 13.36 4 12.69 4 12s.1-1.36.26-2h3.38c-.08.66-.14 1.32-.14 2 0 .68.06 1.34.14 2H4.26zm.82 2h2.95c.32 1.25.78 2.45 1.38 3.56-1.84-.63-3.37-1.9-4.33-3.56zm2.95-8H5.08c.96-1.66 2.49-2.93 4.33-3.56C8.81 5.55 8.35 6.75 8.03 8zM12 19.96c-.83-1.2-1.48-2.53-1.91-3.96h3.82c-.43 1.43-1.08 2.76-1.91 3.96zM14.34 14H9.66c-.09-.66-.16-1.32-.16-2 0-.68.07-1.35.16-2h4.68c.09.65.16 1.32.16 2 0 .68-.07 1.34-.16 2zm.25 5.56c.6-1.11 1.06-2.31 1.38-3.56h2.95c-.96 1.65-2.49 2.93-4.33 3.56zM16.36 14c.08-.66.14-1.32.14-2 0-.68-.06-1.34-.14-2h3.38c.16.64.26 1.31.26 2s-.1 1.36-.26 2h-3.38z"/>
                </svg>
                Languages Spoken
              </h3>
              <div class="flex flex-wrap gap-2">
                <% @provider_profile.languages.split(',').each do |language| %>
                  <span class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-sm font-medium">
                    <%= language.strip %>
                  </span>
                <% end %>
              </div>
            </div>
          <% end %>
        </section>

        <!-- Services/Packages Section -->
        <section id="services" class="bg-white rounded-2xl shadow-lg p-8">
          <h2 class="text-3xl font-bold text-gray-900 mb-6 flex items-center">
            <svg class="w-8 h-8 mr-3 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
              <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
            </svg>
            Service Packages
          </h2>

          <% if @provider_profile.services.where(is_active: true).any? %>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
              <% @provider_profile.services.where(is_active: true).limit(3).each_with_index do |service, index| %>
                <div class="border-2 <%= index == 1 ? 'border-indigo-600 shadow-xl scale-105' : 'border-gray-200' %> rounded-xl p-6 hover:shadow-2xl transition-all duration-300 relative">
                  <% if index == 1 %>
                    <div class="absolute -top-3 left-1/2 transform -translate-x-1/2">
                      <span class="bg-indigo-600 text-white px-4 py-1 rounded-full text-sm font-semibold">Most Popular</span>
                    </div>
                  <% end %>

                  <div class="text-center mb-4">
                    <h3 class="text-xl font-bold text-gray-900 mb-2"><%= service.name %></h3>
                    <div class="text-4xl font-bold text-indigo-600 mb-1">
                      $<%= number_with_precision(service.price, precision: 0) %>
                    </div>
                    <p class="text-gray-600 text-sm"><%= service.duration_minutes %> minutes session</p>
                  </div>

                  <div class="mb-6">
                    <p class="text-gray-700 text-sm leading-relaxed"><%= service.description %></p>
                  </div>

                  <div class="space-y-3 mb-6">
                    <div class="flex items-start gap-2">
                      <svg class="w-5 h-5 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                      </svg>
                      <span class="text-sm text-gray-700"><%= service.duration_minutes %> minute consultation</span>
                    </div>
                    <div class="flex items-start gap-2">
                      <svg class="w-5 h-5 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                      </svg>
                      <span class="text-sm text-gray-700">Video or in-person session</span>
                    </div>
                    <div class="flex items-start gap-2">
                      <svg class="w-5 h-5 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41z"/>
                      </svg>
                      <span class="text-sm text-gray-700">Follow-up notes included</span>
                    </div>
                  </div>

                  <% if user_signed_in? && current_user.patient? %>
                    <%= link_to "Book Appointment", new_appointment_path(service_id: service.id), class: "block w-full text-center px-6 py-3 #{index == 1 ? 'bg-indigo-600 hover:bg-indigo-700' : 'bg-gray-900 hover:bg-gray-800'} text-white rounded-lg font-semibold transition-colors", data: { turbo: false } %>
                  <% else %>
                    <%= link_to "Sign In to Book", new_user_session_path, class: "block w-full text-center px-6 py-3 #{index == 1 ? 'bg-indigo-600 hover:bg-indigo-700' : 'bg-gray-900 hover:bg-gray-800'} text-white rounded-lg font-semibold transition-colors" %>
                  <% end %>
                </div>
              <% end %>
            </div>
          <% else %>
            <div class="text-center py-12">
              <svg class="w-24 h-24 mx-auto text-gray-300 mb-4" fill="currentColor" viewBox="0 0 24 24">
                <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
              </svg>
              <h3 class="text-xl font-semibold text-gray-600 mb-2">No Services Available</h3>
              <p class="text-gray-500">This provider hasn't added any services yet.</p>
            </div>
          <% end %>
        </section>
      </div>

      <!-- Sidebar -->
      <div class="lg:col-span-1">
        <div class="sticky top-24 space-y-6">
          <!-- Booking Widget -->
          <div id="booking" class="bg-white rounded-2xl shadow-lg p-6" data-controller="availability-calendar" data-availability-calendar-provider-id-value="<%= @provider_profile.id %>" data-availability-calendar-availabilities-value='<%= @provider_profile.availabilities.where(is_booked: false).where("start_time >= ?", Time.current).to_json.html_safe %>'>
            <h3 class="text-2xl font-bold text-gray-900 mb-4 flex items-center">
              <svg class="w-6 h-6 mr-2 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
              </svg>
              Book Appointment
            </h3>

            <!-- Consultation Rate -->
            <div class="bg-gradient-to-br from-indigo-600 to-purple-600 rounded-xl p-6 text-white mb-6 relative overflow-hidden">
              <!-- Decorative circles -->
              <div class="absolute top-0 right-0 w-24 h-24 bg-white opacity-10 rounded-full -mr-12 -mt-12"></div>
              <div class="absolute bottom-0 left-0 w-16 h-16 bg-white opacity-10 rounded-full -ml-8 -mb-8"></div>

              <div class="relative z-10">
                <p class="text-sm opacity-90 mb-1 flex items-center">
                  <svg class="w-4 h-4 mr-1" fill="currentColor" viewBox="0 0 24 24">
                    <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"/>
                  </svg>
                  Starting from
                </p>
                <p class="text-4xl font-bold mb-1">
                  $<%= number_with_precision(@provider_profile.consultation_rate, precision: 0) %>
                </p>
                <p class="text-sm opacity-90">per session</p>
              </div>
            </div>

            <!-- Available Slots -->
            <% available_slots = @provider_profile.availabilities.where(is_booked: false).where("start_time >= ?", Time.current).order(start_time: :asc).limit(4) %>

            <% if available_slots.any? %>
              <div class="mb-6">
                <h4 class="font-semibold text-gray-900 mb-4 flex items-center justify-between">
                  <span class="flex items-center">
                    <svg class="w-5 h-5 mr-2 text-green-500" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/>
                    </svg>
                    Next Available
                  </span>
                  <span class="text-xs text-gray-500 font-normal"><%= @provider_profile.availabilities.where(is_booked: false).where("start_time >= ?", Time.current).count %> slots open</span>
                </h4>

                <!-- Modern Card-Style Slots -->
                <div class="grid grid-cols-2 gap-3 mb-4">
                  <% available_slots.each do |availability| %>
                    <div class="group relative bg-gradient-to-br from-gray-50 to-white border-2 border-gray-200 rounded-xl p-3 hover:border-indigo-400 hover:shadow-md transition-all duration-200">
                      <!-- Date Badge -->
                      <div class="flex items-center justify-center mb-2">
                        <div class="bg-indigo-100 text-indigo-700 px-3 py-1 rounded-lg text-xs font-bold">
                          <%= availability.start_time.strftime("%b %d") %>
                        </div>
                      </div>

                      <!-- Time Display -->
                      <div class="text-center mb-2">
                        <p class="text-lg font-bold text-gray-900 leading-tight">
                          <%= availability.start_time.strftime("%I:%M") %>
                        </p>
                        <p class="text-xs text-gray-500">
                          <%= availability.start_time.strftime("%p") %>
                        </p>
                      </div>

                      <!-- Day of Week -->
                      <p class="text-xs text-center text-gray-600 mb-2">
                        <%= availability.start_time.strftime("%A") %>
                      </p>

                      <!-- Book Button -->
                      <% if user_signed_in? && current_user.patient? %>
                        <%= link_to new_appointment_path(provider_profile_id: @provider_profile.id, availability_id: availability.id),
                            class: "block w-full text-center px-2 py-1.5 bg-indigo-600 text-white text-xs font-semibold rounded-lg hover:bg-indigo-700 transition opacity-0 group-hover:opacity-100" do %>
                          Book
                        <% end %>
                      <% end %>
                    </div>
                  <% end %>
                </div>
              </div>

              <!-- View All Availability Button -->
              <% if user_signed_in? && current_user.patient? %>
                <button data-action="click->availability-calendar#openModal"
                        class="block w-full text-center px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-semibold hover:from-indigo-700 hover:to-purple-700 transition shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 mb-4 group">
                  <span class="flex items-center justify-center">
                    <svg class="w-5 h-5 mr-2 group-hover:scale-110 transition" fill="currentColor" viewBox="0 0 24 24">
                      <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                    </svg>
                    View Full Calendar
                  </span>
                </button>
              <% elsif !user_signed_in? %>
                <%= link_to "Sign In to Book", new_user_session_path, class: "block w-full text-center px-6 py-3 bg-gradient-to-r from-indigo-600 to-purple-600 text-white rounded-xl font-semibold hover:from-indigo-700 hover:to-purple-700 transition shadow-lg mb-4" %>
              <% end %>
            <% else %>
              <div class="text-center py-8 mb-4 bg-gray-50 rounded-xl border-2 border-dashed border-gray-300">
                <svg class="w-16 h-16 mx-auto text-gray-300 mb-3" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM7 10h5v5H7z"/>
                </svg>
                <p class="text-gray-600 font-semibold mb-1">No availability yet</p>
                <p class="text-sm text-gray-500">Check back soon for available time slots</p>
              </div>
            <% end %>

            <!-- Calendar Modal -->
            <div data-availability-calendar-target="modal"
                 data-action="click->availability-calendar#closeOnBackdrop keydown@window->availability-calendar#handleKeydown"
                 class="hidden fixed inset-0 bg-black bg-opacity-50 z-50 items-center justify-center p-4">
              <div class="bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden" onclick="event.stopPropagation()">
                <!-- Modal Header -->
                <div class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white p-6">
                  <div class="flex items-center justify-between">
                    <div>
                      <h3 class="text-2xl font-bold">Select a Date & Time</h3>
                      <p class="text-sm opacity-90 mt-1">Choose from available slots below</p>
                    </div>
                    <button data-action="click->availability-calendar#closeModal"
                            class="text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-2 transition">
                      <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
                      </svg>
                    </button>
                  </div>
                </div>

                <!-- Modal Body -->
                <div class="p-6 overflow-y-auto max-h-[calc(90vh-200px)]">
                  <div class="grid md:grid-cols-2 gap-6">
                    <!-- Calendar Section -->
                    <div>
                      <div class="flex items-center justify-between mb-4">
                        <button data-action="click->availability-calendar#previousMonth"
                                class="p-2 hover:bg-gray-100 rounded-lg transition">
                          <svg class="w-5 h-5 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/>
                          </svg>
                        </button>
                        <h4 data-availability-calendar-target="monthYear" class="text-lg font-bold text-gray-900">
                          <!-- Month Year will be inserted here -->
                        </h4>
                        <button data-action="click->availability-calendar#nextMonth"
                                class="p-2 hover:bg-gray-100 rounded-lg transition">
                          <svg class="w-5 h-5 text-gray-600" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/>
                          </svg>
                        </button>
                      </div>

                      <div data-availability-calendar-target="calendar">
                        <!-- Calendar grid will be inserted here -->
                      </div>

                      <!-- Legend -->
                      <div class="mt-4 flex flex-wrap gap-4 text-xs">
                        <div class="flex items-center">
                          <div class="w-4 h-4 bg-green-50 border-2 border-green-200 rounded mr-2"></div>
                          <span class="text-gray-600">Available</span>
                        </div>
                        <div class="flex items-center">
                          <div class="w-4 h-4 bg-indigo-600 rounded mr-2"></div>
                          <span class="text-gray-600">Selected</span>
                        </div>
                        <div class="flex items-center">
                          <div class="w-4 h-4 bg-gray-100 border-2 border-indigo-300 rounded mr-2"></div>
                          <span class="text-gray-600">Today</span>
                        </div>
                      </div>
                    </div>

                    <!-- Time Slots Section -->
                    <div>
                      <h4 class="text-lg font-bold text-gray-900 mb-2">Available Times</h4>
                      <p data-availability-calendar-target="selectedDate" class="text-sm text-gray-600 mb-4">
                        Select a date to view available time slots
                      </p>

                      <div data-availability-calendar-target="timeSlots" class="min-h-[300px]">
                        <p class="text-gray-500 text-center py-8">Select a date to view available time slots</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Contact Info -->
          <div class="bg-white rounded-2xl shadow-lg p-6">
            <h3 class="text-lg font-bold text-gray-900 mb-4">Contact Information</h3>

            <% if @provider_profile.phone.present? %>
              <div class="flex items-center gap-3 mb-3 text-gray-700">
                <svg class="w-5 h-5 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M6.62 10.79c1.44 2.83 3.76 5.14 6.59 6.59l2.2-2.2c.27-.27.67-.36 1.02-.24 1.12.37 2.33.57 3.57.57.55 0 1 .45 1 1V20c0 .55-.45 1-1 1-9.39 0-17-7.61-17-17 0-.55.45-1 1-1h3.5c.55 0 1 .45 1 1 0 1.25.2 2.45.57 3.57.11.35.03.74-.25 1.02l-2.2 2.2z"/>
                </svg>
                <span class="text-sm"><%= @provider_profile.phone %></span>
              </div>
            <% end %>

            <% if @provider_profile.office_address.present? %>
              <div class="flex items-start gap-3 mb-3 text-gray-700">
                <svg class="w-5 h-5 text-indigo-600 mt-0.5" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/>
                </svg>
                <span class="text-sm"><%= @provider_profile.office_address %></span>
              </div>
            <% end %>

            <% if @provider_profile.website.present? %>
              <div class="flex items-center gap-3 text-gray-700">
                <svg class="w-5 h-5 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/>
                </svg>
                <%= link_to @provider_profile.website, @provider_profile.website, target: "_blank", class: "text-sm text-indigo-600 hover:underline" %>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Admin Actions (only visible to profile owner) -->
  <% if user_signed_in? && policy(@provider_profile).edit? %>
    <div class="fixed bottom-6 right-6 flex flex-col gap-3 z-50">
      <%= link_to edit_provider_profile_path(@provider_profile),
          class: "flex items-center justify-center w-14 h-14 bg-indigo-600 text-white rounded-full shadow-lg hover:bg-indigo-700 transition",
          title: "Edit Profile" do %>
        <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
          <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
        </svg>
      <% end %>
    </div>
  <% end %>
</div>
