<div class="min-h-screen bg-gray-50">
  <!-- Header Section -->
  <div class="bg-white border-b border-gray-200">
    <div class="dashboard-container">
      <div class="dashboard-header">
        <div class="flex justify-between items-start">
          <div>
            <h1 class="dashboard-title">Provider Dashboard</h1>
            <p class="dashboard-subtitle">Welcome back, <%= current_user.first_name %> <%= current_user.last_name %></p>
          </div>
          <%= link_to "Edit Profile", edit_provider_profile_path(@provider_profile), class: "btn-primary" %>
        </div>
      </div>

      <!-- Statistics Cards -->
      <div class="stats-grid pb-8">
        <!-- Total Services Card -->
        <div class="stats-card stats-card-primary">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm font-medium text-gray-600 mb-1">Total Services</p>
              <h3 class="text-3xl font-bold text-gray-900"><%= @total_services %></h3>
            </div>
            <div class="stats-card-icon">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
              </svg>
            </div>
          </div>
        </div>

        <!-- Available Slots Card -->
        <div class="stats-card stats-card-success">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm font-medium text-gray-600 mb-1">Available Slots</p>
              <h3 class="text-3xl font-bold text-gray-900"><%= @total_availability_slots %></h3>
            </div>
            <div class="stats-card-icon">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            </div>
          </div>
        </div>

        <!-- Total Earnings Card -->
        <div class="stats-card stats-card-warning">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm font-medium text-gray-600 mb-1">Total Earnings</p>
              <h3 class="text-3xl font-bold text-gray-900">
                <%= number_to_currency(@total_earnings || 0, unit: "$", precision: 2) %>
              </h3>
              <p class="text-sm text-gray-500 mt-1">
                This month: <%= number_to_currency(@earnings_this_month || 0, unit: "$", precision: 2) %>
              </p>
            </div>
            <div class="stats-card-icon">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="dashboard-container">
    <!-- Recent Payments Section -->
    <div class="dashboard-card mb-8">
      <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
        <div class="flex justify-between items-center">
          <div class="flex items-center">
            <div class="stats-card-icon stats-card-warning mr-3">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-900">Recent Payments</h2>
          </div>
          <%= link_to "View All Payments", payments_path, class: "text-sm font-medium text-blue-600 hover:text-blue-700" %>
        </div>
      </div>

      <div class="p-6">
        <% if @recent_payments.any? %>
          <div class="overflow-x-auto">
            <table class="modern-table">
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Client</th>
                  <th>Service</th>
                  <th>Amount</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <% @recent_payments.each do |payment| %>
                  <tr>
                    <td><%= payment.created_at.strftime("%b %d, %Y") %></td>
                    <td><%= payment.appointment.patient.full_name %></td>
                    <td><%= truncate(payment.appointment.service.name, length: 30) %></td>
                    <td class="font-semibold"><%= number_to_currency(payment.amount, unit: "$") %></td>
                    <td>
                      <span class="status-badge <%= case payment.status
                                                  when 'succeeded' then 'status-badge-success'
                                                  when 'pending' then 'status-badge-warning'
                                                  when 'refunded' then 'status-badge-neutral'
                                                  else 'status-badge-error'
                                                  end %>">
                        <%= payment.status.titleize %>
                      </span>
                    </td>
                  </tr>
                <% end %>
              </tbody>
            </table>
          </div>
        <% else %>
          <div class="empty-state">
            <div class="empty-state-icon">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
              </svg>
            </div>
            <h3 class="empty-state-title">No payments yet</h3>
            <p class="empty-state-description">Payments from your appointments will appear here</p>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Services Section -->
    <div class="dashboard-card mb-8">
      <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
        <div class="flex justify-between items-center">
          <div class="flex items-center">
            <div class="stats-card-icon stats-card-primary mr-3">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-900">Your Services</h2>
          </div>
          <%= link_to "View All Services", provider_profile_services_path(@provider_profile), class: "text-sm font-medium text-blue-600 hover:text-blue-700" %>
        </div>
      </div>

      <div class="p-6">
        <% if @services.any? %>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <% @services.take(4).each do |service| %>
              <div class="dashboard-card p-4 hover:shadow-md transition-all duration-200">
                <h3 class="text-lg font-semibold text-gray-900 mb-2">
                  <%= link_to service.name, provider_profile_service_path(@provider_profile, service), class: "text-blue-600 hover:text-blue-700" %>
                </h3>
                <p class="text-gray-600 text-sm mb-3 line-clamp-2"><%= truncate(service.description, length: 100) %></p>
                <div class="flex justify-between items-center">
                  <span class="text-blue-600 font-bold">$<%= number_with_precision(service.price, precision: 2) %></span>
                  <span class="text-gray-500 text-sm"><%= service.duration_minutes %> min</span>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
          <div class="empty-state">
            <div class="empty-state-icon">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2" />
              </svg>
            </div>
            <h3 class="empty-state-title">No services yet</h3>
            <p class="empty-state-description">Create your first service to start accepting appointments.</p>
            <%= link_to "Create Your First Service", new_provider_profile_service_path(@provider_profile), class: "btn-primary" %>
          </div>
        <% end %>
      </div>
    </div>

    <!-- Upcoming Availabilities Section -->
    <div class="dashboard-card">
      <div class="px-6 py-4 border-b border-gray-200 bg-gray-50">
        <div class="flex justify-between items-center">
          <div class="flex items-center">
            <div class="stats-card-icon stats-card-success mr-3">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            </div>
            <h2 class="text-xl font-bold text-gray-900">Upcoming Availability</h2>
          </div>
          <%= link_to "Manage Availability", provider_profile_availabilities_path(@provider_profile), class: "text-sm font-medium text-blue-600 hover:text-blue-700" %>
        </div>
      </div>

      <div class="p-6">
        <% if @availabilities.any? %>
          <div class="space-y-3">
            <% @availabilities.each do |availability| %>
              <div class="dashboard-card p-4 hover:shadow-md transition-all duration-200">
                <div class="flex justify-between items-center">
                  <div>
                    <p class="font-semibold text-gray-900">
                      <%= availability.start_time.strftime("%B %d, %Y") %>
                    </p>
                    <p class="text-gray-600 text-sm">
                      <%= availability.start_time.strftime("%I:%M %p") %> - <%= availability.end_time.strftime("%I:%M %p") %>
                    </p>
                  </div>
                  <% if availability.is_booked %>
                    <span class="status-badge status-badge-error">Booked</span>
                  <% else %>
                    <span class="status-badge status-badge-success">Available</span>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
          <div class="empty-state">
            <div class="empty-state-icon">
              <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
              </svg>
            </div>
            <h3 class="empty-state-title">No availability slots</h3>
            <p class="empty-state-description">Add your availability to start accepting appointments.</p>
            <%= link_to "Add Availability", new_provider_profile_availability_path(@provider_profile), class: "btn-primary" %>
          </div>
        <% end %>
      </div>
    </div>
  </div>
</div>
