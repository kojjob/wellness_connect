<nav class="bg-white shadow-lg fixed w-full top-0 z-50" data-controller="navbar">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between h-16">
      <!-- Left Section: Logo & Main Navigation -->
      <div class="flex items-center">
        <!-- Logo -->
        <%= link_to root_path, class: "flex items-center space-x-2 mr-8" do %>
          <svg class="w-8 h-8 text-indigo-600" fill="currentColor" viewBox="0 0 24 24">
            <path d="M12 2L2 7v10c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V7l-10-5z"/>
          </svg>
          <span class="text-xl font-bold bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent hidden sm:block">WellnessConnect</span>
        <% end %>

        <!-- Desktop Navigation -->
        <div class="hidden md:flex items-center space-x-1">
          <!-- Home Link -->
          <%= link_to "Home", root_path, class: "px-3 py-2 rounded-lg text-sm font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition" %>

          <!-- Services Dropdown -->
          <div class="relative" data-controller="dropdown">
            <button type="button"
                    data-action="click->dropdown#toggle"
                    class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition inline-flex items-center"
                    aria-expanded="false"
                    aria-haspopup="true">
              Services
              <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
              </svg>
            </button>
            <div data-dropdown-target="menu"
                 class="hidden absolute left-0 mt-2 w-56 rounded-xl shadow-lg bg-white ring-1 ring-black ring-opacity-5 divide-y divide-gray-100">
              <div class="py-1">
                <%= link_to "#", class: "group flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition" do %>
                  <svg class="mr-3 h-5 w-5 text-gray-400 group-hover:text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M10.394 2.08a1 1 0 00-.788 0l-7 3a1 1 0 000 1.84L5.25 8.051a.999.999 0 01.356-.257l4-1.714a1 1 0 11.788 1.838L7.667 9.088l1.94.831a1 1 0 00.787 0l7-3a1 1 0 000-1.838l-7-3z"/>
                  </svg>
                  Browse All Services
                <% end %>
                <%= link_to "#", class: "group flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition" do %>
                  <svg class="mr-3 h-5 w-5 text-gray-400 group-hover:text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                  </svg>
                  Find Providers
                <% end %>
                <%= link_to "#", class: "group flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition" do %>
                  <svg class="mr-3 h-5 w-5 text-gray-400 group-hover:text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
                  </svg>
                  Book Appointment
                <% end %>
              </div>
            </div>
          </div>

          <!-- Providers Link -->
          <%= link_to "Providers", "#", class: "px-3 py-2 rounded-lg text-sm font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition" %>

          <!-- About Dropdown -->
          <div class="relative" data-controller="dropdown">
            <button type="button"
                    data-action="click->dropdown#toggle"
                    class="px-3 py-2 rounded-lg text-sm font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition inline-flex items-center"
                    aria-expanded="false"
                    aria-haspopup="true">
              About
              <svg class="ml-1 h-4 w-4" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
              </svg>
            </button>
            <div data-dropdown-target="menu"
                 class="hidden absolute left-0 mt-2 w-56 rounded-xl shadow-lg bg-white ring-1 ring-black ring-opacity-5">
              <div class="py-1">
                <%= link_to "#", class: "block px-4 py-3 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition" do %>
                  About Us
                <% end %>
                <%= link_to "#", class: "block px-4 py-3 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition" do %>
                  How It Works
                <% end %>
                <%= link_to "#", class: "block px-4 py-3 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition" do %>
                  Contact Us
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Section: Notifications, User Profile, Auth Buttons -->
      <div class="flex items-center space-x-4">
        <% if user_signed_in? %>
          <!-- Notifications Dropdown -->
          <div class="relative" data-controller="dropdown">
            <button type="button"
                    data-action="click->dropdown#toggle"
                    class="relative p-2 text-gray-600 hover:text-indigo-600 hover:bg-indigo-50 rounded-lg transition"
                    aria-label="Notifications">
              <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"/>
              </svg>
              <!-- Notification Badge -->
              <span class="absolute top-1 right-1 block h-2 w-2 rounded-full bg-red-500 ring-2 ring-white"></span>
            </button>
            <div data-dropdown-target="menu"
                 class="hidden absolute right-0 mt-2 w-80 rounded-xl shadow-lg bg-white ring-1 ring-black ring-opacity-5">
              <div class="p-4 border-b border-gray-200">
                <h3 class="text-sm font-semibold text-gray-900">Notifications</h3>
              </div>
              <div class="max-h-96 overflow-y-auto">
                <!-- Notification Items -->
                <a href="#" class="block px-4 py-3 hover:bg-gray-50 transition">
                  <div class="flex items-start">
                    <div class="flex-shrink-0">
                      <div class="h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center">
                        <svg class="h-5 w-5 text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
                        </svg>
                      </div>
                    </div>
                    <div class="ml-3 flex-1">
                      <p class="text-sm font-medium text-gray-900">Appointment Confirmed</p>
                      <p class="text-xs text-gray-500 mt-1">Your session with Dr. Smith is confirmed for tomorrow at 2 PM</p>
                      <p class="text-xs text-gray-400 mt-1">2 hours ago</p>
                    </div>
                  </div>
                </a>
                <a href="#" class="block px-4 py-3 hover:bg-gray-50 transition">
                  <div class="flex items-start">
                    <div class="flex-shrink-0">
                      <div class="h-10 w-10 rounded-full bg-green-100 flex items-center justify-center">
                        <svg class="h-5 w-5 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                          <path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>
                        </svg>
                      </div>
                    </div>
                    <div class="ml-3 flex-1">
                      <p class="text-sm font-medium text-gray-900">Payment Successful</p>
                      <p class="text-xs text-gray-500 mt-1">Your payment of $150 has been processed</p>
                      <p class="text-xs text-gray-400 mt-1">1 day ago</p>
                    </div>
                  </div>
                </a>
              </div>
              <div class="p-3 border-t border-gray-200">
                <%= link_to "#", class: "block text-center text-sm font-medium text-indigo-600 hover:text-indigo-500" do %>
                  View all notifications
                <% end %>
              </div>
            </div>
          </div>

          <!-- User Profile Dropdown -->
          <div class="relative" data-controller="dropdown">
            <button type="button"
                    data-action="click->dropdown#toggle"
                    class="flex items-center space-x-2 p-1 rounded-lg hover:bg-gray-100 transition"
                    aria-expanded="false"
                    aria-haspopup="true"
                    aria-label="User menu">
              <!-- User Avatar -->
              <div class="h-8 w-8 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white font-semibold text-sm">
                <%= current_user.first_name&.first&.upcase || current_user.email.first.upcase %>
              </div>
              <span class="hidden md:block text-sm font-medium text-gray-700"><%= current_user.first_name || "User" %></span>
              <svg class="hidden md:block h-4 w-4 text-gray-400" fill="currentColor" viewBox="0 0 20 20">
                <path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/>
              </svg>
            </button>
            <div data-dropdown-target="menu"
                 class="hidden absolute right-0 mt-2 w-56 rounded-xl shadow-lg bg-white ring-1 ring-black ring-opacity-5 divide-y divide-gray-100">
              <div class="px-4 py-3">
                <p class="text-sm font-medium text-gray-900"><%= current_user.first_name %> <%= current_user.last_name %></p>
                <p class="text-xs text-gray-500 truncate"><%= current_user.email %></p>
                <span class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-indigo-100 text-indigo-800 mt-2">
                  <%= current_user.role.titleize %>
                </span>
              </div>
              <div class="py-1">
                <%= link_to "#", class: "group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition" do %>
                  <svg class="mr-3 h-5 w-5 text-gray-400 group-hover:text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/>
                  </svg>
                  My Profile
                <% end %>
                <%= link_to "#", class: "group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition" do %>
                  <svg class="mr-3 h-5 w-5 text-gray-400 group-hover:text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z" clip-rule="evenodd"/>
                  </svg>
                  My Appointments
                <% end %>
                <%= link_to "#", class: "group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition" do %>
                  <svg class="mr-3 h-5 w-5 text-gray-400 group-hover:text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                    <path d="M4 4a2 2 0 00-2 2v1h16V6a2 2 0 00-2-2H4z"/>
                    <path fill-rule="evenodd" d="M18 9H2v5a2 2 0 002 2h12a2 2 0 002-2V9zM4 13a1 1 0 011-1h1a1 1 0 110 2H5a1 1 0 01-1-1zm5-1a1 1 0 100 2h1a1 1 0 100-2H9z" clip-rule="evenodd"/>
                  </svg>
                  Billing
                <% end %>
                <%= link_to "#", class: "group flex items-center px-4 py-2 text-sm text-gray-700 hover:bg-indigo-50 hover:text-indigo-600 transition" do %>
                  <svg class="mr-3 h-5 w-5 text-gray-400 group-hover:text-indigo-600" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M11.49 3.17c-.38-1.56-2.6-1.56-2.98 0a1.532 1.532 0 01-2.286.948c-1.372-.836-2.942.734-2.106 2.106.54.886.061 2.042-.947 2.287-1.561.379-1.561 2.6 0 2.978a1.532 1.532 0 01.947 2.287c-.836 1.372.734 2.942 2.106 2.106a1.532 1.532 0 012.287.947c.379 1.561 2.6 1.561 2.978 0a1.533 1.533 0 012.287-.947c1.372.836 2.942-.734 2.106-2.106a1.533 1.533 0 01.947-2.287c1.561-.379 1.561-2.6 0-2.978a1.532 1.532 0 01-.947-2.287c.836-1.372-.734-2.942-2.106-2.106a1.532 1.532 0 01-2.287-.947zM10 13a3 3 0 100-6 3 3 0 000 6z" clip-rule="evenodd"/>
                  </svg>
                  Settings
                <% end %>
              </div>
              <div class="py-1">
                <%= button_to destroy_user_session_path, method: :delete, class: "group flex items-center w-full px-4 py-2 text-sm text-red-700 hover:bg-red-50 transition" do %>
                  <svg class="mr-3 h-5 w-5 text-red-400" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M3 3a1 1 0 00-1 1v12a1 1 0 102 0V4a1 1 0 00-1-1zm10.293 9.293a1 1 0 001.414 1.414l3-3a1 1 0 000-1.414l-3-3a1 1 0 10-1.414 1.414L14.586 9H7a1 1 0 100 2h7.586l-1.293 1.293z" clip-rule="evenodd"/>
                  </svg>
                  Sign Out
                <% end %>
              </div>
            </div>
          </div>
        <% else %>
          <!-- Sign In Button -->
          <%= link_to "Sign In", new_user_session_path, class: "hidden sm:inline-flex items-center px-4 py-2 border border-indigo-600 rounded-lg text-sm font-medium text-indigo-600 bg-white hover:bg-indigo-50 transition" %>
          
          <!-- Get Started Button -->
          <%= link_to new_user_registration_path, class: "inline-flex items-center px-4 py-2 border border-transparent rounded-lg shadow-sm text-sm font-medium text-white bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 transition" do %>
            Get Started
          <% end %>
        <% end %>

        <!-- Mobile Menu Button -->
        <button type="button"
                data-action="click->navbar#toggleMobile"
                class="md:hidden p-2 rounded-lg text-gray-600 hover:text-indigo-600 hover:bg-indigo-50 transition"
                aria-label="Toggle menu">
          <svg class="h-6 w-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/>
          </svg>
        </button>
      </div>
    </div>
  </div>

  <!-- Mobile Menu -->
  <div data-navbar-target="mobileMenu" class="hidden md:hidden border-t border-gray-200">
    <div class="px-2 pt-2 pb-3 space-y-1">
      <%= link_to "Home", root_path, class: "block px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition" %>
      <%= link_to "Services", "#", class: "block px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition" %>
      <%= link_to "Providers", "#", class: "block px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition" %>
      <%= link_to "About", "#", class: "block px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition" %>
      <% unless user_signed_in? %>
        <%= link_to "Sign In", new_user_session_path, class: "block px-3 py-2 rounded-lg text-base font-medium text-gray-700 hover:text-indigo-600 hover:bg-indigo-50 transition sm:hidden" %>
      <% end %>
    </div>
  </div>
</nav>

<!-- Spacer to prevent content from hiding under fixed navbar -->
<div class="h-16"></div>

